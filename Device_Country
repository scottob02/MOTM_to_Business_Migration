#!/bin/zsh

# -------------------------------------------------------------------------
# Jamf Pro Extension Attribute: Wi-Fi Country Code
# Purpose: Retrieves the Country Code broadcast by the connected Wi-Fi router.
# -------------------------------------------------------------------------

# Get the Country Code from system_profiler
# This looks for the "Country Code:" line in the AirPort data.
wifi_country=$(system_profiler SPAirPortDataType 2>/dev/null | awk '/Country Code:/ {print $3}' | head -1)

if [[ -n "$wifi_country" ]]; then
    # Output format example: "DE", "GB", "US"
    echo "<result>$wifi_country</result>"
else
    echo "<result>Unknown (No Wi-Fi/Ethernet only)</result>"
fi

exit 0
